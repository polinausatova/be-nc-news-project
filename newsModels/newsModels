
const db = require("../db/connection.js");


exports.fetchTopics = () => {
    return db.query("SELECT * FROM topics").then((topics) => {

        return topics.rows;
    });
}

exports.fetchComments = (article_id) => {
    if (typeof article_id*1 === NaN) {
        return next();
    } else 
    return db.query(`
    SELECT * FROM comments 
    WHERE comments.article_id = $1 
    ORDER BY comments.created_at DESC;
    `, [article_id]).then((comments) => {
        if (comments.rows.length === 0) {
            return db.query(`
            SELECT * FROM articles
            WHERE articles.article_id = $1
            `, [article_id]).then((articles) => {
                if (articles.rows.length === 0) {
                    return Promise.reject("Article id does not exist");
                } else 
                return [];
            })
        } 
        return comments.rows;
    });

}
